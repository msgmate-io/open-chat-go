{"swagger":"2.0","info":{"contact":{}},"paths":{"/api/v1/chats/create":{"post":{"description":"Create a chat","consumes":["application/json"],"produces":["application/json"],"tags":["chats"],"summary":"Create a chat","responses":{"200":{"description":"Chat created","schema":{"type":"string"}},"400":{"description":"Invalid chat","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/chats/list":{"get":{"description":"Retrieve a list of chats for the authenticated user","consumes":["application/json"],"produces":["application/json"],"tags":["chats"],"summary":"Get user chats","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":40,"description":"Page size","name":"limit","in":"query"},{"type":"string","description":"Chat types to filter by","name":"chat_types","in":"query"}],"responses":{"200":{"description":"Paginated list of chats","schema":{"$ref":"#/definitions/database.Pagination"}},"400":{"description":"Unable to get database or user","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/chats/{chat_uuid}/contact":{"get":{"description":"Retrieve a single contact based on a chat UUID","consumes":["application/json"],"produces":["application/json"],"tags":["contacts"],"summary":"Get contact by chat UUID","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/contacts.ListedContact"}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Chat or contact not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/chats/{chat_uuid}/messages/list":{"get":{"description":"Retrieve a list of messages associated with a specific chat UUID","consumes":["application/json"],"produces":["application/json"],"tags":["messages"],"summary":"Get Chat messages","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":10,"description":"Page size","name":"limit","in":"query"},{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{"200":{"description":"List of chats","schema":{"type":"array","items":{"$ref":"#/definitions/database.Message"}}},"400":{"description":"Invalid user ID","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/chats/{chat_uuid}/messages/send":{"post":{"description":"Send a message to a chat","consumes":["application/json"],"produces":["application/json"],"tags":["messages"],"summary":"Send a message","parameters":[{"description":"Message content","name":"text","in":"body","required":true,"schema":{"$ref":"#/definitions/chats.SendMessage"}},{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{}}},"/api/v1/contacts/add":{"post":{"description":"Add a contact","consumes":["application/json"],"produces":["application/json"],"tags":["contacts"],"summary":"Add a contact","parameters":[{"description":"Contact token","name":"contact_token","in":"body","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Contact added","schema":{"type":"string"}},"400":{"description":"Invalid contact token","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/contacts/list":{"get":{"description":"Retrieve a list of contacts associated with a specific user ID","consumes":["application/json"],"produces":["application/json"],"tags":["contacts"],"summary":"Get user contacts","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":10,"description":"Page size","name":"limit","in":"query"}],"responses":{"200":{"description":"List of contacts","schema":{"type":"array","items":{"$ref":"#/definitions/contacts.PaginatedContacts"}}},"400":{"description":"Invalid user ID","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/contacts/{contact_token}":{"get":{"description":"Retrieve a single contact by their contact token","consumes":["application/json"],"produces":["application/json"],"tags":["contacts"],"summary":"Get contact by token","parameters":[{"type":"string","description":"Contact Token","name":"token","in":"path","required":true}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/contacts.ListedContact"}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Contact not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/federation/bootstrap":{"get":{"description":"Get base64 encoded bootstrap data for registering this node as a bootstrap peer","produces":["application/json"],"tags":["federation"],"summary":"Get bootstrap information","responses":{"200":{"description":"Bootstrap information","schema":{"$ref":"#/definitions/federation.BootstrapResponse"}}}}},"/api/v1/federation/identity":{"get":{"description":"Get the identity of the current node","produces":["application/json"],"tags":["federation"],"summary":"Get own identity","responses":{"200":{"description":"Node identity","schema":{"type":"string"}}}}},"/api/v1/federation/nodes/list":{"get":{"description":"Retrieve a list of federation nodes","consumes":["application/json"],"produces":["application/json"],"tags":["federation"],"summary":"Get federation nodes","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":10,"description":"Page size","name":"limit","in":"query"}],"responses":{"200":{"description":"List of nodes","schema":{"type":"array","items":{"$ref":"#/definitions/federation.PaginatedNodes"}}},"400":{"description":"Invalid request","schema":{"type":"string"}},"403":{"description":"User is not an admin","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/federation/nodes/register":{"post":{"description":"Register a node in the federation network","consumes":["application/json"],"produces":["application/json"],"tags":["federation"],"summary":"Register a Peer to Peer Node","parameters":[{"description":"Node registration details","name":"node","in":"body","required":true,"schema":{"$ref":"#/definitions/federation.RegisterNode"}}],"responses":{"200":{"description":"Node registered successfully","schema":{"$ref":"#/definitions/database.Node"}},"400":{"description":"Invalid JSON or address","schema":{"type":"string"}},"403":{"description":"User is not an admin or network owner","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/federation/nodes/{node_uuid}":{"get":{"description":"Retrieve details of a specific federation node by UUID","consumes":["application/json"],"produces":["application/json"],"tags":["federation"],"summary":"Get federation node details","parameters":[{"type":"string","description":"Node UUID","name":"node_uuid","in":"path","required":true}],"responses":{"200":{"description":"Node details","schema":{"$ref":"#/definitions/federation.NodeDetails"}},"400":{"description":"Invalid request","schema":{"type":"string"}},"403":{"description":"User is not an admin","schema":{"type":"string"}},"404":{"description":"Node not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/federation/proxies/search":{"get":{"description":"Search for proxies by traffic_target, traffic_origin, or tags (admin only)","produces":["application/json"],"tags":["federation"],"summary":"Search proxies","parameters":[{"type":"string","description":"Search query string","name":"q","in":"query","required":true},{"type":"integer","description":"Page number (default: 1)","name":"page","in":"query"},{"type":"integer","description":"Items per page (default: 10)","name":"limit","in":"query"}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/database.Pagination"}},"400":{"description":"Bad Request","schema":{"type":"object","additionalProperties":{"type":"string"}}},"403":{"description":"Forbidden","schema":{"type":"object","additionalProperties":{"type":"string"}}}}}},"/api/v1/integrations/list":{"get":{"description":"Retrieve a paginated list of integrations for the authenticated user","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Get user integrations","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":20,"description":"Page size","name":"limit","in":"query"},{"type":"string","description":"Integration type to filter by","name":"integration_type","in":"query"},{"type":"boolean","description":"Filter by active status","name":"active","in":"query"}],"responses":{"200":{"description":"Paginated list of integrations","schema":{"$ref":"#/definitions/database.Pagination"}},"400":{"description":"Unable to get database or user","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/{id}":{"get":{"description":"Retrieve a single integration by its ID for the authenticated user","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Get integration by ID","parameters":[{"type":"integer","description":"Integration ID","name":"id","in":"path","required":true}],"responses":{"200":{"description":"Integration details","schema":{"$ref":"#/definitions/integrations.ListedIntegration"}},"400":{"description":"Unable to get database or user","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/{id}/toggle-active":{"post":{"description":"Activate or deactivate an integration by its ID for the authenticated user","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Toggle integration active status","parameters":[{"type":"integer","description":"Integration ID","name":"id","in":"path","required":true},{"description":"Toggle request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.ToggleActiveRequest"}}],"responses":{"200":{"description":"Updated integration details","schema":{"$ref":"#/definitions/integrations.ListedIntegration"}},"400":{"description":"Unable to get database or user","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/interactions/{chat_uuid}/mcp":{"post":{"description":"Handle Model Context Protocol streaming JSON-RPC requests for tool discovery and execution (bot users only)","consumes":["application/json"],"produces":["application/x-ndjson"],"tags":["tools"],"summary":"Handle MCP JSON-RPC streaming requests","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{"200":{"description":"Streaming NDJSON responses","schema":{"type":"string"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/tools.MCPResponse"}},"403":{"description":"Forbidden","schema":{"$ref":"#/definitions/tools.MCPResponse"}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/tools.MCPResponse"}}}}},"/api/v1/interactions/{chat_uuid}/tools":{"get":{"description":"Get the list of available tools for a specific chat (bot users only)","produces":["application/json"],"tags":["tools"],"summary":"Get available tools","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{"200":{"description":"OK","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Bad Request","schema":{"type":"object","additionalProperties":{"type":"string"}}},"403":{"description":"Forbidden","schema":{"type":"object","additionalProperties":{"type":"string"}}},"404":{"description":"Not Found","schema":{"type":"object","additionalProperties":{"type":"string"}}}}}},"/api/v1/interactions/{chat_uuid}/tools/init":{"post":{"description":"Store tool initialization data for a specific chat and tool (bot users only)","consumes":["application/json"],"produces":["application/json"],"tags":["tools"],"summary":"Store tool initialization data","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true},{"description":"Tool init data request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/tools.StoreToolInitDataRequest"}}],"responses":{"200":{"description":"OK","schema":{"type":"object","additionalProperties":{"type":"string"}}},"400":{"description":"Bad Request","schema":{"type":"object","additionalProperties":{"type":"string"}}},"403":{"description":"Forbidden","schema":{"type":"object","additionalProperties":{"type":"string"}}},"404":{"description":"Not Found","schema":{"type":"object","additionalProperties":{"type":"string"}}}}}},"/api/v1/interactions/{chat_uuid}/tools/{tool_name}":{"post":{"description":"Execute a tool for a specific chat interaction (bot users only)","consumes":["application/json"],"produces":["application/json"],"tags":["tools"],"summary":"Execute a tool","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true},{"type":"string","description":"Tool Name","name":"tool_name","in":"path","required":true},{"description":"Tool execution request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/tools.ToolExecutionRequest"}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/tools.ToolExecutionResponse"}},"400":{"description":"Bad Request","schema":{"type":"object","additionalProperties":{"type":"string"}}},"403":{"description":"Forbidden","schema":{"type":"object","additionalProperties":{"type":"string"}}},"404":{"description":"Not Found","schema":{"type":"object","additionalProperties":{"type":"string"}}}}}},"/api/v1/user/2fa/confirm":{"post":{"description":"Verify the 2FA code and enable 2FA for the user","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Confirm Two-Factor Authentication","parameters":[{"description":"2FA confirmation data","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/user.TwoFactorConfirmRequest"}}],"responses":{"200":{"description":"Recovery codes","schema":{"$ref":"#/definitions/user.TwoFactorRecoveryCodesResponse"}},"400":{"description":"Invalid code","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/2fa/disable":{"post":{"description":"Disable 2FA for the user and remove recovery codes","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Disable Two-Factor Authentication","responses":{"200":{"description":"2FA disabled successfully","schema":{"type":"string"}},"400":{"description":"Bad request","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/2fa/recovery-codes":{"post":{"description":"Generate new recovery codes for 2FA (invalidates old ones)","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Generate New Recovery Codes","responses":{"200":{"description":"New recovery codes","schema":{"$ref":"#/definitions/user.TwoFactorRecoveryCodesResponse"}},"400":{"description":"Bad request","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/2fa/setup":{"post":{"description":"Generate a new 2FA secret and QR code URL for the user","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Setup Two-Factor Authentication","responses":{"200":{"description":"2FA setup data","schema":{"$ref":"#/definitions/user.TwoFactorSetupResponse"}},"400":{"description":"Bad request","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/login":{"post":{"description":"Authenticate and login a user with email and password","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Login a user","parameters":[{"description":"Login credentials","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/user.UserLogin"}}],"responses":{"200":{"description":"Login successful","schema":{"type":"string"}},"400":{"description":"Invalid email or password","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/logout":{"post":{"description":"Invalidates the user's session token","consumes":["application/json"],"produces":["application/json"],"tags":["accounts"],"summary":"Logout a user","responses":{"200":{"description":"Logout successful","schema":{"type":"string"}},"401":{"description":"Unauthorized","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/register":{"post":{"description":"Register a user","consumes":["application/json"],"produces":["application/json"],"tags":["accounts"],"summary":"Register a user","parameters":[{"description":"Name","name":"name","in":"body","required":true,"schema":{"type":"string"}},{"description":"Email","name":"email","in":"body","required":true,"schema":{"type":"string"}},{"description":"Password","name":"password","in":"body","required":true,"schema":{"type":"string"}}],"responses":{"201":{"description":"User created","schema":{"type":"string"}},"400":{"description":"Password too short","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/users/self":{"get":{"description":"Retrieve the current user's information","consumes":["application/json"],"produces":["application/json"],"tags":["users"],"summary":"Get current user","responses":{"200":{"description":"Current user details","schema":{"$ref":"#/definitions/database.User"}},"400":{"description":"Invalid user ID","schema":{"type":"string"}}}}}},"definitions":{"chats.FileAttachment":{"type":"object","properties":{"display_name":{"type":"string"},"file_id":{"type":"string"},"file_name":{"type":"string"},"file_size":{"type":"integer"},"mime_type":{"type":"string"}}},"chats.SendMessage":{"type":"object","properties":{"attachments":{"type":"array","items":{"$ref":"#/definitions/chats.FileAttachment"}},"meta_data":{"type":"object","additionalProperties":true},"reasoning":{"type":"array","items":{"type":"string"}},"text":{"type":"string"},"tool_calls":{"type":"array","items":{}}}},"contacts.ListedContact":{"type":"object","properties":{"contact_token":{"type":"string"},"is_online":{"type":"boolean"},"name":{"type":"string"},"profile_data":{"type":"object","additionalProperties":true},"user_uuid":{"type":"string"}}},"contacts.PaginatedContacts":{"type":"object","properties":{"limit":{"type":"integer"},"page":{"type":"integer"},"rows":{"type":"array","items":{"$ref":"#/definitions/contacts.ListedContact"}},"sort":{"type":"string"},"total_pages":{"type":"integer"}}},"database.Message":{"type":"object","properties":{"data_type":{"type":"string"},"meta_data":{"type":"array","items":{"type":"integer"}},"read_at":{"type":"string"},"reasoning":{"type":"array","items":{"type":"string"}},"text":{"type":"string"},"tool_calls":{"type":"array","items":{"type":"array","items":{"type":"integer"}}},"uuid":{"type":"string"}}},"database.Node":{"type":"object","properties":{"addresses":{"type":"array","items":{"$ref":"#/definitions/database.NodeAddress"}},"last_changed":{"type":"string"},"node_name":{"type":"string"},"peer_id":{"type":"string"},"uuid":{"type":"string"}}},"database.NodeAddress":{"type":"object","properties":{"address":{"type":"string"},"uuid":{"type":"string"}}},"database.Pagination":{"type":"object","properties":{"limit":{"type":"integer"},"page":{"type":"integer"},"rows":{},"sort":{"type":"string"},"total_pages":{"type":"integer"}}},"database.User":{"type":"object","properties":{"contact_token":{"type":"string"},"is_admin":{"type":"boolean"},"name":{"type":"string"},"two_factor_enabled":{"type":"boolean"},"uuid":{"type":"string"}}},"federation.BootstrapResponse":{"type":"object","properties":{"bootstrap_data":{"type":"string"},"node_name":{"type":"string"}}},"federation.ListedNode":{"type":"object","properties":{"addresses":{"type":"array","items":{"$ref":"#/definitions/database.NodeAddress"}},"latest_contact":{"type":"string"},"network_memberships":{"type":"array","items":{"$ref":"#/definitions/federation.SimpleNetworkMember"}},"node_name":{"type":"string"},"peer_id":{"type":"string"},"uuid":{"type":"string"}}},"federation.NodeDetails":{"type":"object","properties":{"addresses":{"type":"array","items":{"$ref":"#/definitions/database.NodeAddress"}},"latest_contact":{"type":"string"},"network_memberships":{"type":"array","items":{"$ref":"#/definitions/federation.SimpleNetworkMember"}},"node_name":{"type":"string"},"peer_id":{"type":"string"},"uuid":{"type":"string"}}},"federation.PaginatedNodes":{"type":"object","properties":{"limit":{"type":"integer"},"page":{"type":"integer"},"rows":{"type":"array","items":{"$ref":"#/definitions/federation.ListedNode"}},"sort":{"type":"string"},"total_pages":{"type":"integer"}}},"federation.RegisterNode":{"type":"object","properties":{"add_to_network":{"type":"string"},"addresses":{"type":"array","items":{"type":"string"}},"last_changed":{"type":"string"},"name":{"type":"string"}}},"federation.SimpleNetworkMember":{"type":"object","properties":{"deleted_at":{"type":"string"},"last_sync":{"type":"string"},"network_name":{"type":"string"},"status":{"type":"string"}}},"integrations.ListedIntegration":{"type":"object","properties":{"active":{"type":"boolean"},"config":{"type":"object","additionalProperties":true},"created_at":{"type":"string"},"id":{"type":"integer"},"integration_name":{"type":"string"},"integration_type":{"type":"string"},"last_used":{"type":"string"},"updated_at":{"type":"string"},"user_id":{"type":"integer"}}},"integrations.ToggleActiveRequest":{"type":"object","properties":{"active":{"type":"boolean"}}},"tools.MCPError":{"type":"object","properties":{"code":{"type":"integer"},"data":{},"message":{"type":"string"}}},"tools.MCPResponse":{"type":"object","properties":{"error":{"$ref":"#/definitions/tools.MCPError"},"id":{},"jsonrpc":{"type":"string"},"result":{}}},"tools.StoreToolInitDataRequest":{"type":"object","properties":{"expires_at":{"description":"ISO 8601 timestamp","type":"string"},"init_data":{"type":"object","additionalProperties":true},"tool_name":{"type":"string"}}},"tools.ToolExecutionRequest":{"type":"object","properties":{"input_parameters":{"type":"object","additionalProperties":true}}},"tools.ToolExecutionResponse":{"type":"object","properties":{"error":{"type":"string"},"result":{"type":"string"},"success":{"type":"boolean"},"tool_info":{"type":"object","additionalProperties":true}}},"user.TwoFactorConfirmRequest":{"type":"object","properties":{"code":{"type":"string"},"secret":{"type":"string"}}},"user.TwoFactorRecoveryCodesResponse":{"type":"object","properties":{"codes":{"type":"array","items":{"type":"string"}}}},"user.TwoFactorSetupResponse":{"type":"object","properties":{"qr_code_url":{"type":"string"},"secret":{"type":"string"}}},"user.UserLogin":{"type":"object","properties":{"email":{"type":"string"},"password":{"type":"string"},"recovery_code":{"type":"string"},"two_factor_code":{"type":"string"}}}}}