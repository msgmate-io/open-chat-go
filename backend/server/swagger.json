{"swagger":"2.0","info":{"description":"API for Open Chat application","title":"Open Chat API","contact":{},"version":"1.0"},"paths":{"/api/v1/chats/create":{"post":{"security":[{"SessionAuth":[]}],"description":"Create a new chat with another user, optionally including a first message and attachments","consumes":["application/json"],"produces":["application/json"],"tags":["chats"],"summary":"Create a chat","parameters":[{"description":"Chat creation request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/chats.CreateChat"}}],"responses":{"200":{"description":"Chat created successfully","schema":{"$ref":"#/definitions/chats.ListedChat"}},"400":{"description":"Invalid request - bad JSON, missing contact token, or invalid contact token\" Example(\"Invalid contact token\")","schema":{"type":"string"}},"500":{"description":"Internal server error - failed to marshal attachment metadata\" Example(\"Failed to marshal attachment metadata\")","schema":{"type":"string"}}}}},"/api/v1/chats/list":{"get":{"description":"Retrieve a list of chats for the authenticated user","consumes":["application/json"],"produces":["application/json"],"tags":["chats"],"summary":"Get user chats","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":40,"description":"Page size","name":"limit","in":"query"},{"type":"string","description":"Chat types to filter by","name":"chat_types","in":"query"}],"responses":{"200":{"description":"Paginated list of chats","schema":{"$ref":"#/definitions/database.Pagination"}},"400":{"description":"Unable to get database or user","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/chats/{chat_uuid}/contact":{"get":{"description":"Retrieve a single contact based on a chat UUID","consumes":["application/json"],"produces":["application/json"],"tags":["contacts"],"summary":"Get contact by chat UUID","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/contacts.ListedContact"}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Chat or contact not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/chats/{chat_uuid}/messages/list":{"get":{"description":"Retrieve a list of messages associated with a specific chat UUID","consumes":["application/json"],"produces":["application/json"],"tags":["messages"],"summary":"Get Chat messages","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":10,"description":"Page size","name":"limit","in":"query"},{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{"200":{"description":"List of chats","schema":{"type":"array","items":{"$ref":"#/definitions/database.Message"}}},"400":{"description":"Invalid user ID","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/chats/{chat_uuid}/messages/send":{"post":{"description":"Send a message to a chat","consumes":["application/json"],"produces":["application/json"],"tags":["messages"],"summary":"Send a message","parameters":[{"description":"Message content","name":"text","in":"body","required":true,"schema":{"$ref":"#/definitions/chats.SendMessage"}},{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{}}},"/api/v1/contacts/add":{"post":{"description":"Add a contact","consumes":["application/json"],"produces":["application/json"],"tags":["contacts"],"summary":"Add a contact","parameters":[{"description":"Contact token","name":"contact_token","in":"body","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Contact added","schema":{"type":"string"}},"400":{"description":"Invalid contact token","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/contacts/list":{"get":{"description":"Retrieve a list of contacts associated with a specific user ID","consumes":["application/json"],"produces":["application/json"],"tags":["contacts"],"summary":"Get user contacts","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":10,"description":"Page size","name":"limit","in":"query"}],"responses":{"200":{"description":"List of contacts","schema":{"type":"array","items":{"$ref":"#/definitions/contacts.PaginatedContacts"}}},"400":{"description":"Invalid user ID","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/contacts/{contact_token}":{"get":{"description":"Retrieve a single contact by their contact token","consumes":["application/json"],"produces":["application/json"],"tags":["contacts"],"summary":"Get contact by token","parameters":[{"type":"string","description":"Contact Token","name":"token","in":"path","required":true}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/contacts.ListedContact"}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Contact not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/federation/bootstrap":{"get":{"description":"Get base64 encoded bootstrap data for registering this node as a bootstrap peer","produces":["application/json"],"tags":["federation"],"summary":"Get bootstrap information","responses":{"200":{"description":"Bootstrap information","schema":{"$ref":"#/definitions/federation.BootstrapResponse"}}}}},"/api/v1/federation/identity":{"get":{"description":"Get the identity of the current node","produces":["application/json"],"tags":["federation"],"summary":"Get own identity","responses":{"200":{"description":"Node identity","schema":{"type":"string"}}}}},"/api/v1/federation/nodes/list":{"get":{"description":"Retrieve a list of federation nodes","consumes":["application/json"],"produces":["application/json"],"tags":["federation"],"summary":"Get federation nodes","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":10,"description":"Page size","name":"limit","in":"query"}],"responses":{"200":{"description":"List of nodes","schema":{"type":"array","items":{"$ref":"#/definitions/federation.PaginatedNodes"}}},"400":{"description":"Invalid request","schema":{"type":"string"}},"403":{"description":"User is not an admin","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/federation/nodes/register":{"post":{"description":"Register a node in the federation network","consumes":["application/json"],"produces":["application/json"],"tags":["federation"],"summary":"Register a Peer to Peer Node","parameters":[{"description":"Node registration details","name":"node","in":"body","required":true,"schema":{"$ref":"#/definitions/federation.RegisterNode"}}],"responses":{"200":{"description":"Node registered successfully","schema":{"$ref":"#/definitions/database.Node"}},"400":{"description":"Invalid JSON or address","schema":{"type":"string"}},"403":{"description":"User is not an admin or network owner","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/federation/nodes/{node_uuid}":{"get":{"description":"Retrieve details of a specific federation node by UUID","consumes":["application/json"],"produces":["application/json"],"tags":["federation"],"summary":"Get federation node details","parameters":[{"type":"string","description":"Node UUID","name":"node_uuid","in":"path","required":true}],"responses":{"200":{"description":"Node details","schema":{"$ref":"#/definitions/federation.NodeDetails"}},"400":{"description":"Invalid request","schema":{"type":"string"}},"403":{"description":"User is not an admin","schema":{"type":"string"}},"404":{"description":"Node not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/federation/proxies/search":{"get":{"description":"Search for proxies by traffic_target, traffic_origin, or tags (admin only)","produces":["application/json"],"tags":["federation"],"summary":"Search proxies","parameters":[{"type":"string","description":"Search query string","name":"q","in":"query","required":true},{"type":"integer","description":"Page number (default: 1)","name":"page","in":"query"},{"type":"integer","description":"Items per page (default: 10)","name":"limit","in":"query"}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/database.Pagination"}},"400":{"description":"Bad Request","schema":{"type":"object","additionalProperties":{"type":"string"}}},"403":{"description":"Forbidden","schema":{"type":"object","additionalProperties":{"type":"string"}}}}}},"/api/v1/integrations/create":{"post":{"description":"Create a new integration for the authenticated user. Supports different integration types (e.g., signal). For Signal integrations, this sets up a Docker container and configures the integration.","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Create integration","parameters":[{"description":"Integration creation request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.CreateIntegrationRequest"}}],"responses":{"201":{"description":"Integration created successfully","schema":{"$ref":"#/definitions/integrations.CreateIntegrationResponse"}},"400":{"description":"Invalid request or missing required fields","schema":{"type":"string"}},"409":{"description":"Integration with this name already exists","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/list":{"get":{"description":"Retrieve a paginated list of integrations for the authenticated user","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Get user integrations","parameters":[{"type":"integer","default":1,"description":"Page number","name":"page","in":"query"},{"type":"integer","default":20,"description":"Page size","name":"limit","in":"query"},{"type":"string","description":"Integration type to filter by","name":"integration_type","in":"query"},{"type":"boolean","description":"Filter by active status","name":"active","in":"query"}],"responses":{"200":{"description":"Paginated list of integrations","schema":{"$ref":"#/definitions/database.Pagination"}},"400":{"description":"Unable to get database or user","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/devices":{"get":{"description":"Lists all known devices for the Matrix integration's user","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"List Matrix devices","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true}],"responses":{"200":{"description":"List of devices","schema":{"type":"array","items":{"$ref":"#/definitions/integrations.MatrixDeviceInfo"}}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/devices/{device_id}/trust":{"post":{"description":"Marks a specific device as trusted for encrypted communication","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Trust Matrix device","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true},{"type":"string","description":"Device ID to trust","name":"device_id","in":"path","required":true}],"responses":{"200":{"description":"Device trusted","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/rooms":{"get":{"description":"Lists all rooms the Matrix bot has joined","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"List Matrix rooms","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true}],"responses":{"200":{"description":"List of rooms","schema":{"type":"array","items":{"$ref":"#/definitions/integrations.MatrixRoomInfo"}}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/rooms/{room_id}/join":{"post":{"description":"Joins a Matrix room by ID or alias","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Join Matrix room","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true},{"type":"string","description":"Room ID or alias to join","name":"room_id","in":"path","required":true}],"responses":{"200":{"description":"Room joined","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/send":{"post":{"description":"Sends a message to a Matrix room (will be encrypted if room is encrypted)","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Send Matrix message","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true},{"description":"Message to send","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.SendMatrixMessageRequest"}}],"responses":{"200":{"description":"Message sent","schema":{"$ref":"#/definitions/integrations.SendMatrixMessageResponse"}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/verification/start":{"post":{"description":"Initiates a device verification process for the Matrix integration","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Start Matrix device verification","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true},{"description":"Verification request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.MatrixVerifyDeviceRequest"}}],"responses":{"200":{"description":"Verification started","schema":{"$ref":"#/definitions/integrations.MatrixVerifyDeviceResponse"}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/verification/status":{"get":{"description":"Returns the device verification status and other devices for a Matrix integration","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Get Matrix verification status","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true}],"responses":{"200":{"description":"Verification status","schema":{"$ref":"#/definitions/integrations.MatrixVerificationStatus"}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/verification/{transaction_id}/cancel":{"post":{"description":"Cancels a pending verification process","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Cancel Matrix verification","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true},{"type":"string","description":"Transaction ID","name":"transaction_id","in":"path","required":true}],"responses":{"200":{"description":"Verification cancelled","schema":{"$ref":"#/definitions/integrations.MatrixVerifyDeviceResponse"}},"400":{"description":"Invalid request","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/verification/{transaction_id}/confirm":{"post":{"description":"Confirms a pending verification process","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Confirm Matrix verification","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true},{"type":"string","description":"Transaction ID","name":"transaction_id","in":"path","required":true}],"responses":{"200":{"description":"Verification confirmed","schema":{"$ref":"#/definitions/integrations.MatrixVerifyDeviceResponse"}},"400":{"description":"Invalid request","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/whitelist":{"get":{"description":"Returns the list of whitelisted Matrix users/rooms for AI processing","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Get Matrix whitelist","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true}],"responses":{"200":{"description":"Whitelist","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/whitelist/add":{"post":{"description":"Adds a Matrix user ID to the whitelist for AI processing","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Add to Matrix whitelist","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true},{"description":"User to add","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.AddToMatrixWhitelistRequest"}}],"responses":{"200":{"description":"User added","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/matrix/{integration_id}/whitelist/remove":{"post":{"description":"Removes a Matrix user ID from the whitelist","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Remove from Matrix whitelist","parameters":[{"type":"integer","description":"Integration ID","name":"integration_id","in":"path","required":true},{"description":"User to remove","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.RemoveFromMatrixWhitelistRequest"}}],"responses":{"200":{"description":"User removed","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}}}}},"/api/v1/integrations/signal/install":{"post":{"description":"Install a Signal REST API integration by starting a Docker container and configuring the integration. Creates a Signal system user if it doesn't exist.","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Install Signal REST API integration","parameters":[{"description":"Signal installation request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.InstallSignalRestRequest"}}],"responses":{"201":{"description":"Integration installed successfully","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Invalid request, missing fields, or Docker not available","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/signal/uninstall":{"post":{"description":"Uninstall a Signal REST API integration by stopping and removing the Docker container, archiving data, and marking the integration as inactive.","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Uninstall Signal REST API integration","parameters":[{"description":"Signal uninstallation request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.UninstallSignalRestRequest"}}],"responses":{"200":{"description":"Integration uninstalled successfully with archive path","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Invalid request or missing alias","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/signal/{alias}/whitelist":{"get":{"description":"Retrieve the list of whitelisted phone numbers for a Signal integration. Only whitelisted numbers can send messages through the integration.","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Get Signal whitelist","parameters":[{"type":"string","description":"Signal integration alias","name":"alias","in":"path","required":true}],"responses":{"200":{"description":"Whitelist of phone numbers","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Unable to get database or user, or alias missing","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/signal/{alias}/whitelist/add":{"post":{"description":"Add a phone number to the whitelist of a Signal integration. Whitelisted numbers are allowed to send messages through the integration.","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Add to Signal whitelist","parameters":[{"type":"string","description":"Signal integration alias","name":"alias","in":"path","required":true},{"description":"Phone number to add","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.SignalWhitelistRequest"}}],"responses":{"200":{"description":"Success message","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Unable to get database or user, alias missing, or invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/signal/{alias}/whitelist/remove":{"post":{"description":"Remove a phone number from the whitelist of a Signal integration. The number will no longer be able to send messages through the integration.","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Remove from Signal whitelist","parameters":[{"type":"string","description":"Signal integration alias","name":"alias","in":"path","required":true},{"description":"Phone number to remove","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.SignalWhitelistRequest"}}],"responses":{"200":{"description":"Success message","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Unable to get database or user, alias missing, or invalid request","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/{id}":{"get":{"description":"Retrieve a single integration by its ID for the authenticated user","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Get integration by ID","parameters":[{"type":"integer","description":"Integration ID","name":"id","in":"path","required":true}],"responses":{"200":{"description":"Integration details","schema":{"$ref":"#/definitions/integrations.ListedIntegration"}},"400":{"description":"Unable to get database or user","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}},"delete":{"description":"Delete an integration by its ID for the authenticated user. This also handles integration-specific cleanup such as stopping Docker containers for Signal integrations.","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Delete integration","parameters":[{"type":"integer","description":"Integration ID","name":"id","in":"path","required":true}],"responses":{"200":{"description":"Success message","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Unable to get database or user or invalid ID","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/{id}/toggle-active":{"post":{"description":"Activate or deactivate an integration by its ID for the authenticated user","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Toggle integration active status","parameters":[{"type":"integer","description":"Integration ID","name":"id","in":"path","required":true},{"description":"Toggle request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/integrations.ToggleActiveRequest"}}],"responses":{"200":{"description":"Updated integration details","schema":{"$ref":"#/definitions/integrations.ListedIntegration"}},"400":{"description":"Unable to get database or user","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/integrations/{integration_type}/{integration_alias}/status":{"get":{"description":"Retrieve the status and health of an integration by type and alias. For Signal integrations, this checks the Docker container health and account configuration status.","consumes":["application/json"],"produces":["application/json"],"tags":["integrations"],"summary":"Get integration status","parameters":[{"type":"string","description":"Integration type (e.g., signal)","name":"integration_type","in":"path","required":true},{"type":"string","description":"Integration alias/name","name":"integration_alias","in":"path","required":true}],"responses":{"200":{"description":"Integration status including health and configuration state","schema":{"$ref":"#/definitions/integrations.IntegrationStatus"}},"400":{"description":"Unable to get database or user, or integration not active","schema":{"type":"string"}},"404":{"description":"Integration not found","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/interactions/{chat_uuid}/mcp":{"post":{"description":"Handle Model Context Protocol streaming JSON-RPC requests for tool discovery and execution (bot users only)","consumes":["application/json"],"produces":["application/x-ndjson"],"tags":["tools"],"summary":"Handle MCP JSON-RPC streaming requests","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{"200":{"description":"Streaming NDJSON responses","schema":{"type":"string"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/tools.MCPResponse"}},"403":{"description":"Forbidden","schema":{"$ref":"#/definitions/tools.MCPResponse"}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/tools.MCPResponse"}}}}},"/api/v1/interactions/{chat_uuid}/tools":{"get":{"description":"Get the list of available tools for a specific chat (bot users only)","produces":["application/json"],"tags":["tools"],"summary":"Get available tools","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true}],"responses":{"200":{"description":"OK","schema":{"type":"object","additionalProperties":true}},"400":{"description":"Bad Request","schema":{"type":"object","additionalProperties":{"type":"string"}}},"403":{"description":"Forbidden","schema":{"type":"object","additionalProperties":{"type":"string"}}},"404":{"description":"Not Found","schema":{"type":"object","additionalProperties":{"type":"string"}}}}}},"/api/v1/interactions/{chat_uuid}/tools/init":{"post":{"description":"Store tool initialization data for a specific chat and tool (bot users only)","consumes":["application/json"],"produces":["application/json"],"tags":["tools"],"summary":"Store tool initialization data","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true},{"description":"Tool init data request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/tools.StoreToolInitDataRequest"}}],"responses":{"200":{"description":"OK","schema":{"type":"object","additionalProperties":{"type":"string"}}},"400":{"description":"Bad Request","schema":{"type":"object","additionalProperties":{"type":"string"}}},"403":{"description":"Forbidden","schema":{"type":"object","additionalProperties":{"type":"string"}}},"404":{"description":"Not Found","schema":{"type":"object","additionalProperties":{"type":"string"}}}}}},"/api/v1/interactions/{chat_uuid}/tools/{tool_name}":{"post":{"description":"Execute a tool for a specific chat interaction (bot users only)","consumes":["application/json"],"produces":["application/json"],"tags":["tools"],"summary":"Execute a tool","parameters":[{"type":"string","description":"Chat UUID","name":"chat_uuid","in":"path","required":true},{"type":"string","description":"Tool Name","name":"tool_name","in":"path","required":true},{"description":"Tool execution request","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/tools.ToolExecutionRequest"}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/tools.ToolExecutionResponse"}},"400":{"description":"Bad Request","schema":{"type":"object","additionalProperties":{"type":"string"}}},"403":{"description":"Forbidden","schema":{"type":"object","additionalProperties":{"type":"string"}}},"404":{"description":"Not Found","schema":{"type":"object","additionalProperties":{"type":"string"}}}}}},"/api/v1/user/2fa/confirm":{"post":{"description":"Verify the 2FA code and enable 2FA for the user","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Confirm Two-Factor Authentication","parameters":[{"description":"2FA confirmation data","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/user.TwoFactorConfirmRequest"}}],"responses":{"200":{"description":"Recovery codes","schema":{"$ref":"#/definitions/user.TwoFactorRecoveryCodesResponse"}},"400":{"description":"Invalid code","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/2fa/disable":{"post":{"description":"Disable 2FA for the user and remove recovery codes","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Disable Two-Factor Authentication","responses":{"200":{"description":"2FA disabled successfully","schema":{"type":"string"}},"400":{"description":"Bad request","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/2fa/recovery-codes":{"post":{"description":"Generate new recovery codes for 2FA (invalidates old ones)","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Generate New Recovery Codes","responses":{"200":{"description":"New recovery codes","schema":{"$ref":"#/definitions/user.TwoFactorRecoveryCodesResponse"}},"400":{"description":"Bad request","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/2fa/setup":{"post":{"description":"Generate a new 2FA secret and QR code URL for the user","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Setup Two-Factor Authentication","responses":{"200":{"description":"2FA setup data","schema":{"$ref":"#/definitions/user.TwoFactorSetupResponse"}},"400":{"description":"Bad request","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/login":{"post":{"description":"Authenticate and login a user with email and password","consumes":["application/json"],"produces":["application/json"],"tags":["user"],"summary":"Login a user","parameters":[{"description":"Login credentials","name":"request","in":"body","required":true,"schema":{"$ref":"#/definitions/user.UserLogin"}},{"type":"string","description":"Optional: cookie origin URL (e.g. https://app.example.com) used to derive the session cookie Domain","name":"cookie_origin","in":"query"},{"type":"string","description":"Optional: cookie domain (e.g. app.example.com) used for the session cookie Domain","name":"cookie_domain","in":"query"}],"responses":{"200":{"description":"Login successful","schema":{"type":"string"}},"400":{"description":"Invalid email or password","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/logout":{"post":{"description":"Invalidates the user's session token","consumes":["application/json"],"produces":["application/json"],"tags":["accounts"],"summary":"Logout a user","responses":{"200":{"description":"Logout successful","schema":{"type":"string"}},"401":{"description":"Unauthorized","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/user/register":{"post":{"description":"Register a user","consumes":["application/json"],"produces":["application/json"],"tags":["accounts"],"summary":"Register a user","parameters":[{"description":"Name","name":"name","in":"body","required":true,"schema":{"type":"string"}},{"description":"Email","name":"email","in":"body","required":true,"schema":{"type":"string"}},{"description":"Password","name":"password","in":"body","required":true,"schema":{"type":"string"}}],"responses":{"201":{"description":"User created","schema":{"type":"string"}},"400":{"description":"Password too short","schema":{"type":"string"}},"500":{"description":"Internal server error","schema":{"type":"string"}}}}},"/api/v1/users/self":{"get":{"description":"Retrieve the current user's information","consumes":["application/json"],"produces":["application/json"],"tags":["users"],"summary":"Get current user","responses":{"200":{"description":"Current user details","schema":{"$ref":"#/definitions/database.User"}},"400":{"description":"Invalid user ID","schema":{"type":"string"}}}}}},"definitions":{"chats.CreateChat":{"type":"object","properties":{"attachments":{"type":"array","items":{"$ref":"#/definitions/chats.FileAttachment"}},"chat_type":{"type":"string"},"contact_token":{"type":"string"},"first_message":{"type":"string"},"shared_config":{"type":"array","items":{"type":"integer"}}}},"chats.FileAttachment":{"type":"object","properties":{"display_name":{"type":"string"},"file_id":{"type":"string"},"file_name":{"type":"string"},"file_size":{"type":"integer"},"mime_type":{"type":"string"}}},"chats.ListedChat":{"type":"object","properties":{"chat_type":{"type":"string"},"config":{},"latest_message":{"$ref":"#/definitions/database.Message"},"partner":{"$ref":"#/definitions/database.User"},"uuid":{"type":"string"}}},"chats.SendMessage":{"type":"object","properties":{"attachments":{"type":"array","items":{"$ref":"#/definitions/chats.FileAttachment"}},"meta_data":{"type":"object","additionalProperties":true},"reasoning":{"type":"array","items":{"type":"string"}},"text":{"type":"string"},"tool_calls":{"type":"array","items":{}}}},"contacts.ListedContact":{"type":"object","properties":{"contact_token":{"type":"string"},"is_online":{"type":"boolean"},"name":{"type":"string"},"profile_data":{"type":"object","additionalProperties":true},"user_uuid":{"type":"string"}}},"contacts.PaginatedContacts":{"type":"object","properties":{"limit":{"type":"integer"},"page":{"type":"integer"},"rows":{"type":"array","items":{"$ref":"#/definitions/contacts.ListedContact"}},"sort":{"type":"string"},"total_pages":{"type":"integer"}}},"database.Integration":{"type":"object","properties":{"active":{"type":"boolean"},"config":{"description":"Encrypted configuration data","type":"array","items":{"type":"integer"}},"integration_name":{"type":"string"},"integration_type":{"type":"string"},"last_used":{"type":"string"},"user_id":{"type":"integer"},"uuid":{"type":"string"}}},"database.Message":{"type":"object","properties":{"data_type":{"type":"string"},"meta_data":{"type":"array","items":{"type":"integer"}},"read_at":{"type":"string"},"reasoning":{"type":"array","items":{"type":"string"}},"text":{"type":"string"},"tool_calls":{"type":"array","items":{"type":"array","items":{"type":"integer"}}},"uuid":{"type":"string"}}},"database.Node":{"type":"object","properties":{"addresses":{"type":"array","items":{"$ref":"#/definitions/database.NodeAddress"}},"last_changed":{"type":"string"},"node_name":{"type":"string"},"peer_id":{"type":"string"},"uuid":{"type":"string"}}},"database.NodeAddress":{"type":"object","properties":{"address":{"type":"string"},"uuid":{"type":"string"}}},"database.Pagination":{"type":"object","properties":{"limit":{"type":"integer"},"page":{"type":"integer"},"rows":{},"sort":{"type":"string"},"total_pages":{"type":"integer"}}},"database.User":{"type":"object","properties":{"contact_token":{"type":"string"},"is_admin":{"type":"boolean"},"name":{"type":"string"},"two_factor_enabled":{"type":"boolean"},"uuid":{"type":"string"}}},"federation.BootstrapResponse":{"type":"object","properties":{"bootstrap_data":{"type":"string"},"node_name":{"type":"string"}}},"federation.ListedNode":{"type":"object","properties":{"addresses":{"type":"array","items":{"$ref":"#/definitions/database.NodeAddress"}},"latest_contact":{"type":"string"},"network_memberships":{"type":"array","items":{"$ref":"#/definitions/federation.SimpleNetworkMember"}},"node_name":{"type":"string"},"peer_id":{"type":"string"},"uuid":{"type":"string"}}},"federation.NodeDetails":{"type":"object","properties":{"addresses":{"type":"array","items":{"$ref":"#/definitions/database.NodeAddress"}},"latest_contact":{"type":"string"},"network_memberships":{"type":"array","items":{"$ref":"#/definitions/federation.SimpleNetworkMember"}},"node_name":{"type":"string"},"peer_id":{"type":"string"},"uuid":{"type":"string"}}},"federation.PaginatedNodes":{"type":"object","properties":{"limit":{"type":"integer"},"page":{"type":"integer"},"rows":{"type":"array","items":{"$ref":"#/definitions/federation.ListedNode"}},"sort":{"type":"string"},"total_pages":{"type":"integer"}}},"federation.RegisterNode":{"type":"object","properties":{"add_to_network":{"type":"string"},"addresses":{"type":"array","items":{"type":"string"}},"last_changed":{"type":"string"},"name":{"type":"string"}}},"federation.SimpleNetworkMember":{"type":"object","properties":{"deleted_at":{"type":"string"},"last_sync":{"type":"string"},"network_name":{"type":"string"},"status":{"type":"string"}}},"integrations.AddToMatrixWhitelistRequest":{"type":"object","properties":{"user_id":{"description":"Matrix user ID to whitelist","type":"string"}}},"integrations.CreateIntegrationRequest":{"type":"object","properties":{"config":{"type":"object","additionalProperties":true},"integration_name":{"type":"string"},"integration_type":{"type":"string"}}},"integrations.CreateIntegrationResponse":{"type":"object","properties":{"integration":{"$ref":"#/definitions/database.Integration"},"message":{"type":"string"}}},"integrations.InstallSignalRestRequest":{"type":"object","properties":{"alias":{"type":"string"},"mode":{"type":"string"},"phone_number":{"type":"string"},"port":{"type":"integer"}}},"integrations.IntegrationStatus":{"type":"object","properties":{"data":{},"health":{"type":"string"},"status":{"type":"string"}}},"integrations.ListedIntegration":{"type":"object","properties":{"active":{"type":"boolean"},"config":{"type":"object","additionalProperties":true},"created_at":{"type":"string"},"id":{"type":"integer"},"integration_name":{"type":"string"},"integration_type":{"type":"string"},"last_used":{"type":"string"},"updated_at":{"type":"string"},"user_id":{"type":"integer"}}},"integrations.MatrixDeviceInfo":{"type":"object","properties":{"device_id":{"type":"string"},"display_name":{"type":"string"},"last_seen_at":{"type":"string"},"last_seen_ip":{"type":"string"},"verified":{"type":"boolean"}}},"integrations.MatrixRoomInfo":{"type":"object","properties":{"chat_id":{"type":"integer"},"is_direct":{"type":"boolean"},"is_encrypted":{"type":"boolean"},"name":{"type":"string"},"room_alias":{"type":"string"},"room_id":{"type":"string"},"topic":{"type":"string"}}},"integrations.MatrixVerificationStatus":{"type":"object","properties":{"cross_signing_setup":{"type":"boolean"},"device_verified":{"type":"boolean"},"other_devices":{"type":"array","items":{"$ref":"#/definitions/integrations.MatrixDeviceInfo"}},"verification_method":{"type":"string"},"verified_at":{"type":"string"}}},"integrations.MatrixVerifyDeviceRequest":{"type":"object","properties":{"method":{"description":"\"sas\" (emoji), \"qr\", \"manual\"","type":"string"},"target_device_id":{"type":"string"},"target_user_id":{"type":"string"}}},"integrations.MatrixVerifyDeviceResponse":{"type":"object","properties":{"emoji":{"type":"array","items":{"type":"string"}},"message":{"type":"string"},"status":{"type":"string"},"transaction_id":{"type":"string"},"verification_url":{"type":"string"}}},"integrations.RemoveFromMatrixWhitelistRequest":{"type":"object","properties":{"user_id":{"description":"Matrix user ID to remove","type":"string"}}},"integrations.SendMatrixMessageRequest":{"type":"object","properties":{"message":{"type":"string"},"msg_type":{"description":"\"text\", \"notice\", \"emote\"","type":"string"},"room_id":{"type":"string"}}},"integrations.SendMatrixMessageResponse":{"type":"object","properties":{"event_id":{"type":"string"},"message":{"type":"string"},"room_id":{"type":"string"}}},"integrations.SignalWhitelistRequest":{"type":"object","properties":{"phone_number":{"type":"string"}}},"integrations.ToggleActiveRequest":{"type":"object","properties":{"active":{"type":"boolean"}}},"integrations.UninstallSignalRestRequest":{"type":"object","properties":{"alias":{"type":"string"}}},"tools.MCPError":{"type":"object","properties":{"code":{"type":"integer"},"data":{},"message":{"type":"string"}}},"tools.MCPResponse":{"type":"object","properties":{"error":{"$ref":"#/definitions/tools.MCPError"},"id":{},"jsonrpc":{"type":"string"},"result":{}}},"tools.StoreToolInitDataRequest":{"type":"object","properties":{"expires_at":{"description":"ISO 8601 timestamp","type":"string"},"init_data":{"type":"object","additionalProperties":true},"tool_name":{"type":"string"}}},"tools.ToolExecutionRequest":{"type":"object","properties":{"input_parameters":{"type":"object","additionalProperties":true}}},"tools.ToolExecutionResponse":{"type":"object","properties":{"error":{"type":"string"},"result":{"type":"string"},"success":{"type":"boolean"},"tool_info":{"type":"object","additionalProperties":true}}},"user.TwoFactorConfirmRequest":{"type":"object","properties":{"code":{"type":"string"},"secret":{"type":"string"}}},"user.TwoFactorRecoveryCodesResponse":{"type":"object","properties":{"codes":{"type":"array","items":{"type":"string"}}}},"user.TwoFactorSetupResponse":{"type":"object","properties":{"qr_code_url":{"type":"string"},"secret":{"type":"string"}}},"user.UserLogin":{"type":"object","properties":{"email":{"type":"string"},"password":{"type":"string"},"recovery_code":{"type":"string"},"two_factor_code":{"type":"string"}}}},"securityDefinitions":{"SessionAuth":{"description":"Session cookie obtained from login endpoint","type":"apiKey","name":"session_id","in":"cookie"}},"tags":[{"description":"Chats hold a collection of messages and files or meta-data, they are central to how open-chat works and are used to hold information for interactions and integratins","name":"chats"},{"description":"Messages are the atomic data point of open-chat, they may hold any sort of supported information, they may also reference information in external locations. Messages are collected in a chat. Messages can have only one creator/sender but are received by all chat members.","name":"messages"},{"description":"These apis implement custom logic that allow open-chat to interface with seveal existing service or tools. Any functionality is specific to integrations, but they share a common api interface.","name":"integrations"},{"description":"Everything user management related, users are also used to abstract access permissions. Chats have users as participants, only users share each others contact may create a shared chat.","name":"users"}]}